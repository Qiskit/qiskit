cmake_minimum_required (VERSION 3.27)
project (Qiskit)

# We are using CMake to build our C API test suite, and we leverage ctest to run
# those tests.
enable_testing ()

# On Windows, Rust creates "qiskit_cext.dll" + "qiskit_cext.dll.lib" (import lib).
# CMake doesn't know about ".dll.lib" by default, so add it.
if(WIN32)
    set(CMAKE_FIND_LIBRARY_SUFFIXES ".dll.lib" ${CMAKE_FIND_LIBRARY_SUFFIXES})
endif()

# The C API is provided by the qiskit_cext Rust crate. Its header gets
# generated by cbindgen (see `make cheader`).
find_library (qiskit qiskit_cext PATHS ${CMAKE_CURRENT_SOURCE_DIR}/target/debug REQUIRED)

# Generally include the directory for the ``qiskit.h`` file.
include_directories (${CMAKE_CURRENT_SOURCE_DIR}/dist/c/include)
# The remaining CMake configuration is done inside of the C API test suite.
add_subdirectory (test/c)

---
features_transpiler:
  - |
    Added support for working with :class:`.Target` objects that contain two-qubit
    basis gates that contain arbitrary angles, such as :class:`.RZZGate`, to the
    :class:`.ConsolidateBlocks` transpiler pass. The pass previously would not
    correctly estimate the number of gates required for a decomposition which
    would result in blocks not being consolidated where :class:`.UnitarySynthesis`
    could potentially optimize the block. Internally, the gate count estimate is
    done using the :class:`.TwoQubitControlledUDecomposer` class.

    For example::

      from qiskit import QuantumCircuit
      from qiskit.transpiler import generate_preset_pass_manager
      from qiskit.transpiler.passes import ConsolidateBlocks

      qc = QuantumCircuit(2)
      qc.rzz(0.1, 0, 1)
      qc.rzz(0.2, 0, 1)
      # basis_gates contains fractional gate (rzz)
      consolidate_pass = ConsolidateBlocks(basis_gates=["rz", "rzz", "sx", "x", "rx"])
      block = consolidate_pass(qc)  # consolidate the circuit into a single unitary block
      block.draw(output='mpl')

      pm = generate_preset_pass_manager(
          optimization_level=2, basis_gates=["rz", "rzz", "sx", "x", "rx"]
      )
      tqc = pm.run(qc)  # synthesizing the circuit into basis gates
      tqc.draw(output='mpl')
